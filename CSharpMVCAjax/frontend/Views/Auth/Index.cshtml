@model frontend.Models.authModel;


<nav class="mb-5">
    <a id="regi" class="btn btn-success">Register</a>
    <a id="log" class="btn btn-success">Login</a>
</nav>


<div class="register border p-4 w-50 text-center">
    <h4>REGISTER</h4>
    <form id="register" asp-action="register" method="post" enctype="multipart/form-data">
        @* <div id="error-message" class="alert alert-danger" style="display:none;">@TempData["ErrorMessage"]</div> *@


        <table class="table border-light">
            <tr>
                <td><label asp-for="c_name" for="c_name">NAME</label></td>
                <td><input asp-for="c_name" class="form-control" id="c_name"></td>
                <td><span asp-validation-for="c_name" class="text-danger"></span></td>
            </tr>
            <tr>
                <td><label asp-for="c_email">EMAIL</label></td>
                <td><input type="email" asp-for="c_email" class="form-control" id="c_email"></td>
                <td><span asp-validation-for="c_email" class="text-danger"></span></td>
            </tr>
            <tr>
                <td><label asp-for="c_password">PASSWORD</label></td>
                <td><input type="password" asp-for="c_password" class="form-control" id="c_password"></td>
                <td><span asp-validation-for="c_password" class="text-danger"></span></td>
            </tr>
            <tr>
                <td><input type="submit" class="btn btn-primary" value="SignUp"></td>
            </tr>
        </table>
    </form>
</div>

<div class="login mt-5 border p-4 w-50 text-center">
    <h4>LOGIN </h4>
    <form action="" id="login" method="get">
        <table class="table border-light">
            <tr>
                <td><label for="c_email">EMAIL</label></td>
                <td><input type="email" name="c_email" id="c_email"></td>
                <td><span class="text-danger"></span></td>
            </tr>
            <tr>
                <td><label for="c_password">PASSWORD</label></td>
                <td><input type="password" name="c_password" id="c_password"></td>
                <td><span class="text-danger"></span></td>
            </tr>
            <tr>
                <td><input type="submit" class="btn btn-primary" value="Signin"></td>
            </tr>
        </table>
    </form>
</div>

@section Scripts {

    <script>
        $(document).ready(function () {

            $('.login').hide();
            $('.register').hide();
            $('#regi').click(function () {
                $('.register').show();
                $('.login').hide();
            });

            $('#log').click(function () {
                $('.register').hide();
                $('.login').show();
            });


            $("#register").submit(function (event) {
                event.preventDefault();
                var formData = new FormData(this);
                $.ajax({
                    url: "register",
                    type: "POST",
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        
                        if (response.success) {
                            console.log("Registration successful");
                            $("#error-message").text(response.message).hide();
                        } else {
                            console.error("Registration failed:", response.message);
                            $("#error-message").text(response.message).show();
                        }
                    }
                })

            });

            $("#login").submit(function (event) {
                event.preventDefault();
                var formData = new FormData(this);
                $.ajax({
                    url: "login",
                    type: "POST",
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        console.log(response);
                        if (response) {

                            window.location.href = "/Employee/Index";
                        }
                        else {
                            window.location.href = "/Auth/Index";
                        }

                    }
                })
            });
        });
    </script>
}